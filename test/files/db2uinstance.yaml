apiVersion: db2u.databases.ibm.com/v1
kind: Db2uInstance
metadata:
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: '122'
    db2u/certs-api-cert: '[secure]'
    db2u/certs-api-key: '[secure]'
    db2u/certs-wv-rest: '[secure]'
    db2u/license: '[secure]'
    db2u/sshkeys-db2instusr: '[secure]'
    db2u/sshkeys-db2uadm: '[secure]'
    db2u/sshkeys-db2uhausr: '[secure]'
  creationTimestamp: '2024-08-20T15:20:38Z'
  labels:
    app.kubernetes.io/instance: db2-db.as-n-09-vir.stgcpd.manage
  name: db2wh-stgcpd-manage
  namespace: db2u-stgcpd
spec:
  account:
    imagePullSecrets:
      - ibm-registry
    securityConfig:
      privilegedSysctlInit: true
  addOns: {}
  environment:
    authentication:
      ldap:
        blueAdminPassword:
          value: '[secure]'
        enabled: true
        password:
          value: '[secure]'
    databases:
      - dbConfig:
          APPLHEAPSZ: WRONG
          AUTHN_CACHE_DURATION: '10'
          AUTHN_CACHE_USERS: '100'
          AUTO_DB_BACKUP: 'OFF'
          AUTO_DEL_REC_OBJ: 'ON'
          AUTO_MAINT: 'ON'
          AUTO_REORG: 'OFF'
          AUTO_REVAL: DEFERRED
          AUTO_RUNSTATS: 'ON'
          AUTO_TBL_MAINT: 'ON'
          CATALOGCACHE_SZ: '800'
          CHNGPGS_THRESH: '40'
          CUR_COMMIT: 'ON'
          DATABASE_MEMORY: AUTOMATIC
          DBHEAP: AUTOMATIC
          DDL_CONSTRAINT_DEF: 'YES'
          DEC_TO_CHAR_FMT: NEW
          DFT_QUERYOPT: '5'
          DFT_TABLE_ORG: ROW
          LOCKLIST: AUTOMATIC
          LOCKTIMEOUT: '300'
          LOGBUFSZ: '1024'
          LOGFILSIZ: '32768'
          LOGPRIMARY: '100'
          LOGSECOND: '156'
          MAXFILOP: '61440'
          MIRRORLOGPATH: /mnt/backup
          NUM_DB_BACKUPS: '60'
          NUM_IOCLEANERS: AUTOMATIC
          NUM_IOSERVERS: AUTOMATIC
          PCKCACHESZ: AUTOMATIC
          REC_HIS_RETENTN: '60'
          SHEAPTHRES_SHR: automatic
          SOFTMAX: '0'
          SORTHEAP: automatic
          STAT_HEAP_SZ: AUTOMATIC
          STMTHEAP: '20000'
          STMT_CONC: LITERALS
          TRACKMOD: 'YES'
          WLM_ADMISSION_CTRL: 'NO'
        name: BLUDB
        settings:
          dftTableOrg: ROW
    dbType: db2wh
    instance:
      dbmConfig:
        AGENT_STACK_SZ: 'WRONG'
        FENCED_POOL: '50'
        HEALTH_MON: 'OFF'
        KEEPFENCED: 'NO'
        MON_HEAP_SZ: AUTOMATIC
        RQRIOBLK: '65535'
      password:
        value: '[secure]'
      registry:
        DB2AUTH: 'WRONG'
        DB2_4K_DEVICE_SUPPORT: 'ON'
        DB2_BCKP_PAGE_VERIFICATION: 'TRUE'
        DB2_CDE_REDUCED_LOGGING: 'REDUCED_REDO:NO'
        DB2_EVALUNCOMMITTED: 'YES'
        DB2_FMP_COMM_HEAPSZ: '65536'
        DB2_FMP_RUN_AS_CONNECTED_USER: 'NO'
        DB2_INLIST_TO_NLJN: 'YES'
        DB2_MINIMIZE_LISTPREFETCH: 'Y'
        DB2_OBJECT_STORAGE_LOCAL_STAGING_PATH: /mnt/backup/staging
        DB2_SKIPDELETED: 'ON'
        DB2_SKIPINSERTED: 'ON'
        DB2_USE_ALTERNATE_PAGE_CLEANING: 'ON'
        DB2_WORKLOAD: MAXIMO
    partitionConfig:
      dataOnMln0: true
      total: 1
      volumePerPartition: true
    ssl:
      allowSslOnly: true
      certLabel: CN=db2u
      secretName: '[secure]'
  license:
    accept: true
  nodes: 1
  podTemplate:
    db2u:
      resource:
        db2u:
          limits:
            cpu: '8'
            memory: 12Gi
          requests:
            cpu: '4'
            memory: 8Gi
  storage:
    - name: meta
      spec:
        accessModes:
          - ReadWriteMany
        resources:
          requests:
            storage: 20Gi
        storageClassName: efs-csi
      type: create
    - name: backup
      spec:
        accessModes:
          - ReadWriteMany
        resources:
          requests:
            storage: 100Gi
        storageClassName: efs-csi
      type: create
    - name: data
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 100Gi
        storageClassName: efs-csi
      type: template
    - name: tempts
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 100Gi
        storageClassName: efs-csi
      type: template
    - name: activelogs
      spec:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 100Gi
        storageClassName: efs-csi
      type: template
    - name: auditlogs
      spec:
        accessModes:
          - ReadWriteMany
        resources:
          requests:
            storage: 100Gi
        storageClassName: efs-csi
      type: template
    - name: archivelogs
      spec:
        accessModes:
          - ReadWriteMany
        resources:
          requests:
            storage: 100Gi
        storageClassName: efs-csi
      type: create
  version: s11.5.9.0-cn1
status:
  conditions:
    - lastTransitionTime: '2024-08-20T15:21:06Z'
      status: Processing
      type: FormationStatus
  maintenanceState: None
  state: NotReady
  version: s11.5.9.0-cn1